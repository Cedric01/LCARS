@page "/bitbucket/branches"

<PageTitle>LCARS | BitBucket | Branches</PageTitle>

@using LCARS.Data
@inject BranchService branchService

<Header Text="Branches" />

<Branches Data="@branches"/>

@code {
    private IEnumerable<Branch>? branches;

    protected override async Task OnInitializedAsync()
    {
        var timer = new System.Threading.Timer(async (_) =>
        {
            await RefreshBranches();
            await InvokeAsync(StateHasChanged);
        }, null, 0, 10000);
    }

    private async Task RefreshBranches()
    {
        branches = await branchService.GetBitBucketBranchesAsync();
    }
}